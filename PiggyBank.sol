// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract piggybank {
    mapping (address => uint256) public balances;
    
    
    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }
    
    function withdraw(uint256 _amount) public {
        // 출금하려는 금액이 현재 잔액보다 많지 않은지 확인함.
        require(balances[msg.sender] >= _amount, "Insufficient balance");
        balances[msg.sender] -= _amount;

        // 함수를 호출한 사람(msg.sender)에게 _amount 만큼의 이더를 보냄
        // 전송에 실패하면 트랜잭션 전체가 원래대로 되돌아감.
        payable(msg.sender).transfer(_amount);
    }
}

/*
1.이더 입금
yun@LAPTOP-7OM63LLG:~/tokenpr$ cast send 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512 "deposit()" --value 1ether --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --rpc-url http://127.0.0.1:8545

blockHash            0x2d6bcc51c085f4094079180d9e4548b24badc9f0d084305b935a25fbff8ed2d0
blockNumber          3
contractAddress
cumulativeGasUsed    43601
effectiveGasPrice    774814594
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              43601
logs                 []
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root
status               1 (success)
transactionHash      0x2db776a62043a9b77077c95a21dad1f7d284e23151ed50d04397c7d68a275b38
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

2.입금(잔액) 확인
yun@LAPTOP-7OM63LLG:~/tokenpr$ cast call 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512 "balances(address)" 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:8545
0x0000000000000000000000000000000000000000000000000de0b6b3a7640000

1이더리움 입금된거 확인

3. 0.5이더 출금해보기
yun@LAPTOP-7OM63LLG:~/tokenpr$ cast send 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512 "withdraw(uint256)" 500000000000000000 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --rpc-url http://127.0.0.1:8545

blockHash            0x80b245d3b214ef4316d39582ce39254944923f7865cecd9758498817b8446d13
blockNumber          4
contractAddress
cumulativeGasUsed    34076
effectiveGasPrice    678244293
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              34076
logs                 []
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root
status               1 (success)
transactionHash      0xffc867df5c4928ad496b3c5902aab70edfeb237aed2000c8370241a5c58ab8fd
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512

4. 잔액 확인
yun@LAPTOP-7OM63LLG:~/tokenpr$ cast call 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512 "balances(address)" 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:8545
0x00000000000000000000000000000000000000000000000006f05b59d3b20000

0.5 이더리움 남은 것 확인
*/
